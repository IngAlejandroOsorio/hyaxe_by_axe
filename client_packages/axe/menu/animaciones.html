<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Hy AxE | Login</title>
    <link rel='stylesheet' href='./css/bootstrap.min.css'>
    <link rel='stylesheet' href='./css/axe.css'>
    <script src='libs/jquery-3.3.1.min.js'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.js" type="text/javascript"></script>
    <script src='js/keypress.js'></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>

    <style>
        html,
        body {
            height: 100%;
            background-color: rgba(128, 128, 128, 0);
        }
        .butt {
        background-color: rgba(26, 25, 25, 0.8);
        border: none; /* Remove borders */
        color: white; /* White text */
        padding: 12px 16px; /* Some padding */
        font-size: 16px; /* Set a font size */
        cursor: pointer; /* Mouse pointer on hover */
        }

        /* Darker background on mouse-over */
        .butt:hover {
          background-color: #68040e;
        }

        input.active[type=range]::-webkit-slider-thumb {

        border: 3px solid #000000;
        border-radius: 4px;
        background: #ffffff;
        margin-top: -8px; /* You need to specify a margin in Chrome, but in Firefox and IE it is automatic */
        box-shadow: 3px 3px 3px #000000, 0px 0px 3px #0d0d0d; /* Add cool effects to your sliders! */
        }
    
    .alert {
      padding: .25rem 0.9rem !important;
    }
    .card-body {
      padding: 0.55rem !important;
    }
    .btn-sm-peque {
      font-size: .475rem !important;
    }

    .btn {
      font-size: 12px;
    }

    .btn-guardar {
      font-size: 18px;
    }

    .modal-content {
      border: 0px solid #333 !important;
    }

    form-control, input {
      text-align: center;
      font-weight: 700;
      font-size: larger;
    }
    </style>

</head>

<body>
    <!-- partial:index.partial.html -->
    <div class="container-fluid">
      <div id="navigate">
        <div class="row">
            <div class="col-md-2">
                <center><img src="logoaxe.png" class="img-fluid img-responsive"></center>
              
                <div class="card" style="background-color: rgba(26, 25, 25, 0.8)">
                        <div class="alert alert-primary" role="alert">
                                Animaciones
                        </div>

                        <div id="animlist" class="card-body text-white">
                                    
                        </div>
                        <br>
                        <button id="volverBtn" class="btn btn-danger btn-block move">Cerrar</button>
                  </div>
        
            </div>
            

              <div class="col-md-8"></div>
              
              <div class="col-md-2" style="padding-top: 10px;">
                <div class="card" style="background-color: rgba(26, 25, 25, 0.8)">
                        <div class="alert alert-primary" role="alert">
                                Animaciones
                        </div>

                        <div id="animlist2" class="card-body text-white">
                                    
                        </div>
                  </div>

              </div>
            </div>
          </div>
            </div>
        </div>
    </div>

<button id="modalok" type="button" class="btn btn-primary" data-toggle="modal" style="display: none" data-target="#modalConfirmOk">modal</button>
<div class="modal fade" id="modalConfirmOk" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-sm modal-notify modal-danger" role="document">
    <!--Content-->
    <div class="modal-content text-center">
      <!--Header-->
      <div class="modal-header d-flex justify-content-center">
        <div class="alert alert-primary" role="alert">
                               <p class="heading">Presiona la tecla que deseas bindear a esta animación:</p>
                               <input type="text" id="tecla">
                        </div>
       
      </div>


      <!--Footer-->
      <div class="modal-footer flex-center">
        <a href="#" onclick="gogo()" class="btn btn-success btn-block btn-guardar" data-dismiss="modal">Guardar</a>
      </div>
    </div>
    <!--/.Content-->
  </div>
</div>


<!--Modal: modalConfirmDelete-->
    <script>

        function logeo(cosa){
          console.log(cosa);
        }


var active = 0;
var tecla = 0;
var cod_tecla = 0;
var arr_bindeos = JSON.parse('[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]');
rePosition();

$(document).keydown(function(e){
    reCalculate(e);
    rePosition();
    return false;
});

const keyCodes = {
  0: 'Esa tecla no está asignada',
  3: 'Romper',
  8: 'Espacio / Eliminar',
  9: 'Tab',
  12: 'Limpiar',
  13: 'Enter',
  16: 'Shift',
  17: 'CTRL',
  18: 'Alt',
  19: 'Pausa',
  20: 'Bloq-Mayus',
  21: 'Hangul',
  25: 'Hanja',
  27: 'Esc',
  28: 'Conversión',
  29: 'No Conversible',
  32: 'Espacio',
  33: 'Página arriba',
  34: 'Página abajo',
  35: 'Terminar',
  36: 'Inicio',
  37: 'Flecha Izquierda',
  38: 'Flecha Arriba',
  39: 'Flecha Derecha',
  40: 'Flecha Abajo',
  41: 'Seleccionar',
  42: 'Imprimir',
  43: 'Ejecutar',
  44: 'Imprimir Pantalla',
  45: 'Insertar',
  46: 'Eliminar',
  47: 'Ayuda',
  48: '0',
  49: '1',
  50: '2',
  51: '3',
  52: '4',
  53: '5',
  54: '6',
  55: '7',
  56: '8',
  57: '9',
  58: ':',
  59: 'semicolon (firefox), equals',
  60: '<',
  61: 'equals (firefox)',
  63: 'ß',
  64: '@ (firefox)',
  65: 'a',
  66: 'b',
  67: 'c',
  68: 'd',
  69: 'e',
  70: 'f',
  71: 'g',
  72: 'h',
  73: 'i',
  74: 'j',
  75: 'k',
  76: 'l',
  77: 'm',
  78: 'n',
  79: 'o',
  80: 'p',
  81: 'q',
  82: 'r',
  83: 's',
  84: 't',
  85: 'u',
  86: 'v',
  87: 'w',
  88: 'x',
  89: 'y',
  90: 'z',
  91: 'Windows Key / Izquierda ⌘ / Chromebook Search key',
  92: 'right window key',
  93: 'Windows Menu / Derecha ⌘',
  95: 'Descansa',
  96: 'numpad 0',
  97: 'numpad 1',
  98: 'numpad 2',
  99: 'numpad 3',
  100: 'numpad 4',
  101: 'numpad 5',
  102: 'numpad 6',
  103: 'numpad 7',
  104: 'numpad 8',
  105: 'numpad 9',
  106: 'Múltiple',
  107: 'Añadir',
  108: 'Numpad Periodo (firefox)',
  109: 'Sustraer',
  110: 'Punto decimal',
  111: 'Dividir',
  112: 'f1',
  113: 'f2',
  114: 'f3',
  115: 'f4',
  116: 'f5',
  117: 'f6',
  118: 'f7',
  119: 'f8',
  120: 'f9',
  121: 'f10',
  122: 'f11',
  123: 'f12',
  124: 'f13',
  125: 'f14',
  126: 'f15',
  127: 'f16',
  128: 'f17',
  129: 'f18',
  130: 'f19',
  131: 'f20',
  132: 'f21',
  133: 'f22',
  134: 'f23',
  135: 'f24',
  136: 'f25',
  137: 'f26',
  138: 'f27',
  139: 'f28',
  140: 'f29',
  141: 'f30',
  142: 'f31',
  143: 'f32',
  144: 'Num Lock',
  145: 'Bloquear Desplazamiento',
  151: 'Modo avión',
  160: '^',
  161: '!',
  162: '؛ (arabic semicolon)',
  163: '#',
  164: '$',
  165: 'ù',
  166: 'Página atrás',
  167: 'Página adelante',
  168: 'Refrescar',
  169: 'closing paren (AZERTY)',
  170: '*',
  171: '~ + * key',
  172: 'home key',
  173: 'minus (firefox), mute/unmute',
  174: 'Disminuir el nivel del volumen',
  175: 'Incrementar el nivel del volumen',
  176: 'Siguiente',
  177: 'Anterior',
  178: 'Parar',
  179: 'Reproducir/Pausar',
  180: 'E-mail',
  181: 'mute/unmute (firefox)',
  182: 'Disminuir el nivel del volumen (firefox)',
  183: 'Incrementar el nivel del volumen (firefox)',
  186: 'semi-colon / ñ',
  187: 'Signo igual',
  188: 'Coma',
  189: 'Guión',
  190: 'Período',
  191: 'Barra Inclinada / ç',
  192: 'Acento grave / ñ / æ / ö',
  193: '?, / or °',
  194: 'numpad period (chrome)',
  219: 'open bracket',
  220: 'back slash',
  221: 'close bracket / å',
  222: 'single quote / ø / ä',
  223: '`',
  224: 'left or right ⌘ key (firefox)',
  225: 'altgr',
  226: '< /git >, left back slash',
  230: 'GNOME Compose Key',
  231: 'ç',
  233: 'XF86Forward',
  234: 'XF86Back',
  235: 'non-conversion',
  240: 'alphanumeric',
  242: 'hiragana/katakana',
  243: 'half-width/full-width',
  244: 'kanji',
  251: 'unlock trackpad (Chrome/Edge)',
  255: 'toggle touchpad',
};

function reCalculate(e){
    var rows = $('#navigate .move').length;
    var columns = $('#navigate .move:eq(0)').length;
    //alert(columns + 'x' + rows);
    
    if (e.keyCode == 37) { //move left or wrap
        active = (active-columns>=0)?active-columns:active;
    }
    if (e.keyCode == 38) { // move up
        active = (active-columns>=0)?active-columns:active;
    }
    if (e.keyCode == 39) { // move right or wrap
        active = (active+columns<=(rows*columns)-1)?active+columns:active;
    }
    if (e.keyCode == 40) { // move down
        active = (active+columns<=(rows*columns)-1)?active+columns:active;
    }
    if (e.keyCode == 13) {
        $('.active').click();
    }
    if (e.keyCode == 8) {
        mp.trigger("SalirMenuPj");
    }
    tecla = e.keyCode;
    let nombrex = "";

    for (const key in keyCodes) {
      //console.log(keyCodes[key] + "key= "+key);
      if (tecla == key){
        nombrex = keyCodes[key];
      }
    }

    $("#tecla").val(nombrex);
    //console.log(keyCodes.e.keyCode);

}

function gogo(){
  arr_bindeos[cod_tecla] = tecla;
  mp.trigger("guardarBindeos",JSON.stringify(arr_bindeos));
  //var temp_arr = {cod_tecla : tecla};
  //arr_bindeos.push(temp_arr);
  console.log(JSON.stringify(arr_bindeos));
}

function rePosition(){
    $('.active').removeClass('active');
    $('#navigate .move').eq(active).addClass('active');
    scrollInView();
}

function scrollInView(){
    var target = $('#navigate .move:eq('+active+')');
    if (target.length)
    {
        var top = target.offset().top;
        
        $('html,body').stop().animate({scrollTop: top-300}, 400);
        return false;
    }
}


function bindear(id){
  cod_tecla = id;
  $("#modalok").click(); 
  setTimeout(() => {
    $("#tecla").focus();
  }, 100);
}

function reciboBindeos(bindeos){
  //console.log("asi recibo bindeo --- > "+bindeos);
   arr_bindeos = JSON.parse(bindeos);
      //if (!arr_bindeos.length > 0){
        //console.log("------------------->"+typeof bindeos);
        //arr_bindeos = JSON.parse('[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]');
      //}
}

function masAnimaciones(array) {  
    var parsed = JSON.parse(array);
    var i = 0;
    var html = "";
    var html2 = "";
    parsed.forEach(elemento => {
      if (i < 26){
          html += '<center>';
          html += '<button type="button" class="btn btn-success move btn-sm" onClick="mp.trigger(\'IniciarAnimacion\','+i+')">'+elemento+'</button>';
          html += '<button type="button" class="btn btn-danger move btn-sm btn-sm-peque" onClick="bindear('+i+')">Hotkey</button>';
          html += "</center>";
        }else{
          html2 += '<center>';
          html2 += '<button type="button" class="btn btn-success move btn-sm" onClick="mp.trigger(\'IniciarAnimacion\','+i+')">'+elemento+'</button>';
          html2 += '<button type="button" class="btn btn-danger move btn-sm btn-sm-peque" onClick="bindear('+i+')">Hotkey</button>';
          html2 += "</center>";
        }        
        i++    
    });
    //console.log(html);
    $("#animlist").html(html);
    $("#animlist2").html(html2);

    //if (bindeos){     
    
};

    $('#volverBtn').click(() => {            
        mp.trigger("SalirMenuPjMasAnimaciones");
    });

    </script>

    <!-- partial -->
    <script src='libs/bootstrap.min.js'></script>

</body>

</html>